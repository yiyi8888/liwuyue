<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çŒœçŒœæ˜¯è°åœ¨æ”¾å± ğŸ’¨</title>
    <style>
        /* åŸºç¡€æ ·å¼ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "å¾®è½¯é›…é»‘", "Comic Sans MS", sans-serif;
        }

        body {
            background-color: #f0f2f5;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        /* æ¸¸æˆä¸»å®¹å™¨ */
        .game-box {
            background: white;
            border-radius: 20px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.1);
            padding: 30px;
            width: 100%;
            max-width: 700px;
            text-align: center;
        }

        /* æ ‡é¢˜ */
        .game-title {
            color: #e67e22;
            font-size: 2rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .game-title span {
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }

        /* æç¤ºæ–‡æœ¬ */
        .game-tip {
            color: #555;
            font-size: 1rem;
            margin-bottom: 30px;
            line-height: 1.5;
        }

        /* æŒ‰é’®å®¹å™¨ï¼ˆæ ¸å¿ƒï¼šå±…ä¸­æ˜¾ç¤ºï¼‰ */
        .btn-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 10px 0;
        }

        /* æŒ‰é’®æ ·å¼ */
        .btn {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
            border: none;
            border-radius: 50px;
            padding: 12px 36px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(46, 204, 113, 0.3);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-reset {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
            display: none;
        }

        /* è§’è‰²å®¹å™¨ */
        .character-wrap {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 30px 0;
            min-height: 200px;
            position: relative;
            height: 220px;
            width: 100%;
        }

        /* è§’è‰²æ ·å¼ */
        .character {
            width: 100px;
            height: 130px;
            background: linear-gradient(135deg, #3498db, #2980b9);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3.5rem;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            position: absolute;
            border: 3px solid white;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            z-index: 1;
            /* å›ºå®šå‚ç›´ä½ç½®ï¼Œç¡®ä¿åœ¨åŒä¸€æ°´å¹³çº¿ */
            top: 50%;
            transform: translateY(-50%);
        }

        .character:hover {
            transform: translateY(-50%) scale(1.05);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
            z-index: 2;
        }

        .character.disabled {
            cursor: not-allowed;
            opacity: 0.8;
            transform: translateY(-50%);
        }

        /* æ”¾å±åŠ¨æ•ˆ */
        .fart-animate::after {
            content: "ğŸ’¨";
            position: absolute;
            bottom: 10px;
            right: 10px;
            font-size: 1.5rem;
            animation: fart 1s infinite ease-in-out;
            opacity: 0;
        }

        .fart-animate.show::after {
            opacity: 1;
        }

        @keyframes fart {
            0% { transform: translate(0, 0) rotate(0); }
            50% { transform: translate(-5px, -5px) rotate(10deg); }
            100% { transform: translate(0, 0) rotate(0); }
        }

        /* å¼¹æ¡†æ ·å¼ */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .modal.show {
            opacity: 1;
            pointer-events: auto;
        }

        .modal-content {
            background: white;
            border-radius: 16px;
            padding: 30px;
            width: 90%;
            max-width: 400px;
            text-align: center;
            transform: translateY(-20px);
            transition: transform 0.3s ease;
        }

        .modal.show .modal-content {
            transform: translateY(0);
        }

        .modal-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .modal-title {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: #333;
        }

        .modal-text {
            color: #666;
            margin-bottom: 20px;
        }

        .modal-success .modal-icon,
        .modal-success .modal-title {
            color: #2ecc71;
        }

        .modal-fail .modal-icon,
        .modal-fail .modal-title {
            color: #e74c3c;
        }

        /* å“åº”å¼é€‚é… */
        @media (max-width: 600px) {
            .character {
                width: 80px;
                height: 110px;
                font-size: 2.8rem;
            }

            .game-title {
                font-size: 1.6rem;
            }

            .character-wrap {
                height: 180px;
            }
        }
    </style>
</head>
<body>
    <div class="game-box">
        <h1 class="game-title">çŒœçŒœæ˜¯è°åœ¨æ”¾å± <span>ğŸ’¨</span></h1>
        <p class="game-tip" id="gameTip">ç‚¹å‡»å¼€å§‹æ¸¸æˆï¼Œå…ˆæ˜¾ç¤ºæ”¾å±çš„è§’è‰²ï¼Œ1ç§’åæ‰“ä¹±ä½ç½®ï¼Œæ‰¾å‡ºæ”¾å±çš„é‚£ä¸ªï¼</p>
        
        <!-- æŒ‰é’®å®¹å™¨ï¼šå®ç°å±…ä¸­ -->
        <div class="btn-container">
            <button class="btn" id="startBtn">å¼€å§‹æ¸¸æˆ</button>
            <button class="btn btn-reset" id="resetBtn">å†æ¥ä¸€å±€</button>
        </div>
        
        <div class="character-wrap" id="characterWrap"></div>
    </div>

    <!-- æˆåŠŸå¼¹æ¡† -->
    <div class="modal modal-success" id="successModal">
        <div class="modal-content">
            <div class="modal-icon">ğŸ‰</div>
            <h3 class="modal-title">æ­å–œä½ ï¼çŒœå¯¹å•¦</h3>
            <p class="modal-text">ä½ å¤ªå‰å®³äº†ï¼Œå‡†ç¡®æ‰¾åˆ°æ”¾å±çš„è§’è‰²ï¼</p>
            <button class="btn" id="successBtn">å†æ¥ä¸€å±€</button>
        </div>
    </div>

    <!-- å¤±è´¥å¼¹æ¡† -->
    <div class="modal modal-fail" id="failModal">
        <div class="modal-content">
            <div class="modal-icon">ğŸ˜œ</div>
            <h3 class="modal-title">ç­”é”™å•¦ï¼</h3>
            <p class="modal-text">å“ˆå“ˆï¼Œæ”¾å±çš„ä¸æ˜¯è¿™ä¸ªè§’è‰²å“¦ï½</p>
            <button class="btn" id="failBtn">å†æ¥ä¸€å±€</button>
        </div>
    </div>

    <script>
        // æ ¸å¿ƒå˜é‡
        const gameState = {
            isPlaying: false,
            fartIndex: -1,
            characterCount: 0,
            characters: []
        };

        // DOMå…ƒç´ 
        const el = {
            startBtn: document.getElementById('startBtn'),
            resetBtn: document.getElementById('resetBtn'),
            characterWrap: document.getElementById('characterWrap'),
            gameTip: document.getElementById('gameTip'),
            successModal: document.getElementById('successModal'),
            failModal: document.getElementById('failModal'),
            successBtn: document.getElementById('successBtn'),
            failBtn: document.getElementById('failBtn')
        };

        // åˆå§‹åŒ–äº‹ä»¶ç›‘å¬
        function initEvents() {
            el.startBtn.addEventListener('click', startGame);
            // å†æ¥ä¸€å±€ç›´æ¥å¼€å§‹æ¸¸æˆ
            el.resetBtn.addEventListener('click', startGame);
            el.successBtn.addEventListener('click', () => {
                el.successModal.classList.remove('show');
                startGame(); // å¼¹æ¡†ç‚¹å‡»å†æ¥ä¸€å±€ç›´æ¥å¼€å§‹
            });
            el.failBtn.addEventListener('click', () => {
                el.failModal.classList.remove('show');
                startGame(); // å¼¹æ¡†ç‚¹å‡»å†æ¥ä¸€å±€ç›´æ¥å¼€å§‹
            });
        }

        // å¼€å§‹æ¸¸æˆï¼ˆç»Ÿä¸€å…¥å£ï¼šå¼€å§‹æ¸¸æˆ/å†æ¥ä¸€å±€éƒ½è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼‰
        function startGame() {
            // éšè—å¼¹æ¡†ï¼ˆé˜²æ­¢å¼¹æ¡†æœªå…³é—­çš„æƒ…å†µï¼‰
            el.successModal.classList.remove('show');
            el.failModal.classList.remove('show');
            
            // é‡ç½®çŠ¶æ€
            gameState.isPlaying = true;
            gameState.fartIndex = -1;
            gameState.characterCount = 0;
            gameState.characters = [];
            
            // æ›´æ–°UIçŠ¶æ€ï¼šéšè—æŒ‰é’®ï¼Œæ˜¾ç¤ºå‡†å¤‡æç¤º
            el.startBtn.style.display = 'none';
            el.resetBtn.style.display = 'none';
            el.gameTip.textContent = "å‡†å¤‡å¼€å§‹...";
            
            // æ¸…ç©ºè§’è‰²å®¹å™¨
            el.characterWrap.innerHTML = '';
            
            // éšæœºç”Ÿæˆ3-6ä¸ªè§’è‰²
            gameState.characterCount = Math.floor(Math.random() * 4) + 3;
            // éšæœºé€‰æ‹©æ”¾å±çš„è§’è‰²
            gameState.fartIndex = Math.floor(Math.random() * gameState.characterCount);
            
            // åˆ›å»ºè§’è‰²å¹¶åˆå§‹åŒ–ä½ç½®
            createCharacters();
            
            // æ˜¾ç¤ºæ”¾å±åŠ¨æ•ˆ1ç§’
            const fartChar = gameState.characters[gameState.fartIndex];
            fartChar.classList.add('show');
            
            // 1ç§’åéšè—åŠ¨æ•ˆå¹¶æ‰“ä¹±è§’è‰²
            setTimeout(() => {
                fartChar.classList.remove('show');
                el.gameTip.textContent = "è§’è‰²æ­£åœ¨æ‰“ä¹±...";
                disableCharacters(true);
                shuffleCharacters();
            }, 1000);
        }

        // åˆ›å»ºè§’è‰²å…ƒç´ ï¼ˆåŒä¸€æ°´å¹³çº¿åˆå§‹ä½ç½®ï¼‰
        function createCharacters() {
            const wrapRect = el.characterWrap.getBoundingClientRect();
            const charWidth = window.innerWidth <= 600 ? 80 : 100;
            const gap = 20; // è§’è‰²é—´è·
            const totalCharWidth = gameState.characterCount * charWidth + (gameState.characterCount - 1) * gap;
            const startX = (wrapRect.width - totalCharWidth) / 2; // åˆå§‹èµ·å§‹Xåæ ‡
            
            // åˆ›å»ºæ¯ä¸ªè§’è‰²
            for (let i = 0; i < gameState.characterCount; i++) {
                const char = document.createElement('div');
                char.className = 'character';
                char.dataset.index = i;
                char.textContent = 'ğŸ˜€'; // ç»Ÿä¸€å¤´åƒ
                
                // æ ‡è®°æ”¾å±çš„è§’è‰²
                if (i === gameState.fartIndex) {
                    char.classList.add('fart-animate');
                }
                
                // åˆå§‹ä½ç½®ï¼ˆåŒä¸€æ°´å¹³çº¿ï¼‰
                char.style.left = `${startX + i * (charWidth + gap)}px`;
                
                // æ·»åŠ ç‚¹å‡»äº‹ä»¶
                char.addEventListener('click', () => selectCharacter(i));
                
                // æ·»åŠ åˆ°å®¹å™¨å’Œæ•°ç»„
                el.characterWrap.appendChild(char);
                gameState.characters.push(char);
            }
        }

        // æ‰“ä¹±è§’è‰²ä½ç½®ï¼ˆåŒä¸€æ°´å¹³çº¿ï¼Œç»å¯¹ä¸é‡å ï¼‰
        function shuffleCharacters() {
            const wrapRect = el.characterWrap.getBoundingClientRect();
            const charWidth = window.innerWidth <= 600 ? 80 : 100;
            const gap = 20;
            const totalCharWidth = gameState.characterCount * charWidth + (gameState.characterCount - 1) * gap;
            const startX = (wrapRect.width - totalCharWidth) / 2;
            
            // ç”Ÿæˆæ‰“ä¹±åçš„ä½ç½®æ•°ç»„ï¼ˆåŒä¸€æ°´å¹³çº¿ï¼Œç­‰é—´è·ï¼‰
            const originalPositions = [];
            for (let i = 0; i < gameState.characterCount; i++) {
                originalPositions.push(startX + i * (charWidth + gap));
            }
            
            // éšæœºæ‰“ä¹±ä½ç½®æ•°ç»„ï¼ˆFisher-Yatesæ´—ç‰Œç®—æ³•ï¼‰
            const shuffledPositions = [...originalPositions];
            for (let i = shuffledPositions.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffledPositions[i], shuffledPositions[j]] = [shuffledPositions[j], shuffledPositions[i]];
            }
            
            // æ‰§è¡ŒåŠ¨ç”»ï¼ˆ1.5ç§’ï¼‰
            const duration = 1500;
            const startTime = Date.now();
            
            function animate() {
                if (!gameState.isPlaying) return;
                
                const elapsed = Date.now() - startTime;
                const progress = Math.min(elapsed / duration, 1);
                
                // æ›´æ–°æ¯ä¸ªè§’è‰²ä½ç½®ï¼ˆä»…æ°´å¹³ç§»åŠ¨ï¼Œå‚ç›´å›ºå®šï¼‰
                gameState.characters.forEach((char, index) => {
                    const startPos = parseFloat(char.style.left);
                    const targetPos = shuffledPositions[index];
                    
                    // çº¿æ€§åŠ¨ç”»
                    const currentPos = startPos + (targetPos - startPos) * progress;
                    char.style.left = `${currentPos}px`;
                });
                
                if (progress < 1) {
                    requestAnimationFrame(animate);
                } else {
                    // åŠ¨ç”»å®Œæˆ
                    el.gameTip.textContent = "æ‰“ä¹±å®Œæˆï¼ç‚¹å‡»ä½ è®¤ä¸ºæ”¾å±çš„è§’è‰²";
                    disableCharacters(false);
                }
            }
            
            requestAnimationFrame(animate);
        }

        // é€‰æ‹©è§’è‰²åˆ¤æ–­ç»“æœ
        function selectCharacter(index) {
            // æ ¡éªŒæ¸¸æˆçŠ¶æ€
            if (!gameState.isPlaying || gameState.characters[0].classList.contains('disabled')) return;
            
            // ç¦ç”¨æ‰€æœ‰è§’è‰²
            disableCharacters(true);
            
            // æ˜¾ç¤ºæ”¾å±è§’è‰²çš„åŠ¨æ•ˆ
            gameState.characters[gameState.fartIndex].classList.add('show');
            
            // æ˜¾ç¤ºå†æ¥ä¸€å±€æŒ‰é’®ï¼ˆå±…ä¸­ï¼‰
            el.resetBtn.style.display = 'inline-block';
            
            // åˆ¤æ–­ç»“æœå¹¶æ˜¾ç¤ºå¼¹æ¡†
            if (index === gameState.fartIndex) {
                el.successModal.classList.add('show');
            } else {
                el.failModal.classList.add('show');
            }
            
            // æ›´æ–°çŠ¶æ€
            gameState.isPlaying = false;
        }

        // ç¦ç”¨/å¯ç”¨è§’è‰²ç‚¹å‡»
        function disableCharacters(disabled) {
            gameState.characters.forEach(char => {
                if (disabled) {
                    char.classList.add('disabled');
                    char.style.pointerEvents = 'none';
                } else {
                    char.classList.remove('disabled');
                    char.style.pointerEvents = 'auto';
                }
            });
        }

        // åˆå§‹åŒ–æ¸¸æˆ
        function initGame() {
            // åˆå§‹æ˜¾ç¤ºå¼€å§‹æŒ‰é’®ï¼Œéšè—å†æ¥ä¸€å±€
            el.startBtn.style.display = 'inline-block';
            el.resetBtn.style.display = 'none';
            initEvents();
        }

        // å¯åŠ¨æ¸¸æˆ
        initGame();
    </script>
</body>
</html>